<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta name="description" content="Визуализация данных, пошаговое руководство, книга по D3" />
		<meta name="keywords" content="code, art, design, data, visualization, generative, algorithmic, processing, d3, d3.js, book, maps, код, данные, искусство, визуализация, обработка данных, книга, отображение данных" />
		<meta name="author" content="Иванов Сергей" />
	
		<link rel="stylesheet" href="css/metro-bootstrap.css">
		<link rel="stylesheet" href="css/metro-bootstrap-responsive.css">
		<link rel="stylesheet" href="css/iconFont.css">
		<link rel="stylesheet" href="js/prettify/prettify.css">

        <script src="js/jquery/jquery.min.js"></script>
        <script src="js/jquery/jquery.widget.min.js"></script>
        <script src="js/jquery/jquery.mousewheel.js"></script>
		<script src="js/prettify/prettify.js"></script>
        <script src="js/metro/metro.min.js"></script>
		
		<script src="js/docs.js"></script>
		<script src="js/github.info.js"></script>
		<script type="text/javascript">
			var lNavigationDescriptor_obj_arr = [
				{
					pageName : "about.html",
					description : "Об этом руководстве",
					prevPageName : "",
					nextPageName : "fundamentals.html"
				},
				{
					pageName : "fundamentals.html",
					description : "Основы",
					prevPageName : "about.html",
					nextPageName : "setup.html"
				},
				{
					pageName : "setup.html",
					description : "Установка",
					prevPageName : "fundamentals.html",
					nextPageName : "adding_elements.html"
				},
				{
					pageName : "adding_elements.html",
					description : "Добавление элементов",
					prevPageName : "setup.html",
					nextPageName : "chaining_methods.html"
				},
				{
					pageName : "chaining_methods.html",
					description : "Цепочки методов",
					prevPageName : "adding_elements.html",
					nextPageName : "binding_data.html"
				},
				{
					pageName : "binding_data.html",
					description : "Привязка данных",
					prevPageName : "chaining_methods.html",
					nextPageName : "using_your_data.html"
				},
				{
					pageName : "using_your_data.html",
					description : "Использование данных",
					prevPageName : "binding_data.html",
					nextPageName : "drawing_divs.html"
				},
				{
					pageName : "drawing_divs.html",
					description : "Рисование с использованием блоков",
					prevPageName : "using_your_data.html",
					nextPageName : "power_of_data.html"
				},
				{
					pageName : "power_of_data.html",
					description : "Сила метода data()",
					prevPageName : "drawing_divs.html",
					nextPageName : "svg_primer.html"
				},
				{
					pageName : "svg_primer.html",
					description : "Пример с использованием SVG",
					prevPageName : "power_of_data.html",
					nextPageName : "drawing_svgs.html"
				},
				{
					pageName : "drawing_svgs.html",
					description : "Рисование с использованием SVG-элементов",
					prevPageName : "svg_primer.html",
					nextPageName : "types_of_data.html"
				},
				{
					pageName : "types_of_data.html",
					description : "Типы данных",
					prevPageName : "drawing_svgs.html",
					nextPageName : "making_bar_chart.html"
				},
				{
					pageName : "making_bar_chart.html",
					description : "Делаем столбиковую диаграмму",
					prevPageName : "types_of_data.html",
					nextPageName : "making_scatterplot.html"
				},
				{
					pageName : "making_scatterplot.html",
					description : "Делаем точечную диаграмму",
					prevPageName : "making_bar_chart.html",
					nextPageName : "scales.html"
				},
				{
					pageName : "scales.html",
					description : "Масштабирование",
					prevPageName : "making_scatterplot.html",
					nextPageName : "axes.html"
				},
				{
					pageName : "axes.html",
					description : "Координатные оси",
					prevPageName : "scales.html",
					nextPageName : ""
				}
			];
			
			function getPageProperty(aPageName_str, aPropertyName_str) {
				var lPagesCount_int = lNavigationDescriptor_obj_arr.length;
				for (var i = 0; i < lPagesCount_int; i++) {
					var lPageDescriptor_obj = lNavigationDescriptor_obj_arr[i];
					var lPGPageName_str = lPageDescriptor_obj.pageName;
					if (aPageName_str === lPGPageName_str) {
						return lPageDescriptor_obj[aPropertyName_str];
					}
				}
				return "";
			}
			
			window.onload = function () {
				var lPageName_str = location.href.match(/[^/]+\.html/i)[0];
				var lPagesCount_int = lNavigationDescriptor_obj_arr.length;
				for (var i = 0; i < lPagesCount_int; i++) {
					var lPageDescriptor_obj = lNavigationDescriptor_obj_arr[i];
					var lPGPageName_str = lPageDescriptor_obj.pageName;
					if (lPageName_str === lPGPageName_str) {
						var lPGPrevPageName_str = lPageDescriptor_obj.prevPageName;
						var lPGPrevPageDescription_str = getPageProperty(lPGPrevPageName_str, "description");
						var lPGNextPageName_str = lPageDescriptor_obj.nextPageName;
						var lPGNExtPageDescription_str = getPageProperty(lPGNextPageName_str, "description");
						
						var lTopNav_e = $("#top_navigation");
						var lBottomNav_e = $("#bottom_navigation");
						
						if (lPGPrevPageName_str.trim().length > 0) {
							var lPrevPageNav_e = $("<div class=\"span4\" align=\"center\"/>");
							var lLinkText_str = "<i class=\"icon-arrow-left-3\"></i>&nbsp;" + lPGPrevPageDescription_str;
							var lLink_e = $("<a class=\"seganav\" />").attr("href", lPGPrevPageName_str).html(lLinkText_str);
							lPrevPageNav_e.append(lLink_e);
							var lCopyPrevPageNav_e = lPrevPageNav_e.clone();
							lBottomNav_e.append(lPrevPageNav_e);
							lTopNav_e.append(lCopyPrevPageNav_e);
						}
						
						var lContentPageNav_e = $("<div align=\"center\"/>");
						if (lPGPrevPageName_str.trim().length > 0) {
							lContentPageNav_e.addClass("span4");
						} else {
							lContentPageNav_e.addClass("span4 offset4");
						}
						var lLinkText_str = "<i class=\"icon-book\"></i>&nbsp;" + "Оглавление";
						var lLink_e = $("<a class=\"seganav\" />").attr("href", "index.html").html(lLinkText_str);
						lContentPageNav_e.append(lLink_e);
						var lCopyContentPageNav_e = lContentPageNav_e.clone();
						lBottomNav_e.append(lContentPageNav_e);
						lTopNav_e.append(lCopyContentPageNav_e);
						
						if (lPGNextPageName_str.trim().length > 0) {
							var lNextPageNav_e = $("<div class=\"span4\" align=\"center\"/>");
							var lLinkText_str = lPGNExtPageDescription_str + "&nbsp;<i class=\"icon-arrow-right-3\"></i>";
							var lLink_e = $("<a class=\"seganav\" />").attr("href", lPGNextPageName_str).html(lLinkText_str);
							lNextPageNav_e.append(lLink_e);
							var lCopyNextPageNav_e = lNextPageNav_e.clone();
							lBottomNav_e.append(lNextPageNav_e);
							lTopNav_e.append(lCopyNextPageNav_e);
						}
						break;
					}
				}
				if (lPageName_str !== "index.html") {
					$("#top_navigation").show();
					$("#bottom_navigation").show();
				}
			};
		</script>
		<title>Цепочки методов</title>
	</head>
	<body class="metro">
		<div class="container">
			<div class="grid">
				<div class="row">
					<div class="span12">
						<div class="row bg-cyan" id="top_navigation" style="padding: 20px 0; display: none;">
						</div>
						
						<div align="center">
		<h1>Цепочки методов</h1>
	</div>
	<br/>
	<p>D3 ловко использует технику, которая называется цепочками методов, которую вы можете легко узнать, если пользовались библиотекой jQuery. Методы вызываются последовательно один за другим в одной строке кода, выполняя несколько действий - это называется цепочкой методов. Эта техника может быть очень быстрой и удобной, но необходимо понимать, как это работает, чтобы потом часами не сидеть за отладкой кода.</p>
	<p>Так, функции и методы это лишь два разных слова, обозначающих одно и тоже: кусок кода, который может принимать аргументы на вход, выполняет некоторые действия, после чего возвращает некоторые данные тому, кто вызвал метод.</p>
	<p>Давайте заново посмотрим на нашу первую строку кода, использующую D3(<a href="http://alignedleft.com/content/03-tutorials/01-d3/50-chaining-methods/index.html">Демо страница тут</a>):</p>
	<pre class="prettyprint linenums">d3.select("body").append("p").text("New paragraph!");</pre>
	<p>Это может выглядеть как большая каша, в особенности, если вы новичок в программировании. Итак, первым делом нужно усвоить, что JavaScript, также как и HTML, не волнуют пробелы и переходы на новую строку, так что вы можете написать каждый метод на отдельной строке для лучшей наглядности:</p>
	<pre class="prettyprint linenums">
d3.select("body")
    .append("p")
    .text("New paragraph!");</pre>
	<p>Каждый придерживается своего стиля оформления кода. Использование отступов, переходов на новую строку или пробелов(либо табов) работает на вас, помогая лучше воспринимать код.</p>
	<br/>
	<h3>Одна ссылка в момент времени</h3>
	<p>Давайте разберем каждый кусок кода:</p>
	<p><i>d3</i> -  ссылается на D3 объект, из которого мы имеем доступ к методам D3.</p>
	<p><i>.select("body")</i> - дает методу <a href="https://github.com/mbostock/d3/wiki/Selections#wiki-d3_select"><i>select()</i></a> CSS-селектор на вход, а метод, в свою очередь, возвращает ссылку на первый элемент в DOM'e, который подходит под описание селектора(необходимо использовать метод <i>selectAll()</i> для получения группы объектов). В данном случае, нам нужен элемент <i>body</i>, поэтому ссылка на <i>body</i> используется следующим методом в нашей цепочке.</p>
	<p><i>.append("p")</i> - метод <a href="https://github.com/mbostock/d3/wiki/Selections#append"><i>append()</i></a> создает любой DOM-элемент, указанный вами и добавляет его в конец(внутрь) выборки. В нашем случае мы хотим создать новый параграф <i>p</i> внутри тега <i>body</i>. Мы указали <i>p</i> как аргумент функции, которая вызывается у элемента <i>body</i>, который мы выбрали вызовом предыдущего метода <i>select()</i>. В конце-концов, <i>append()</i> возвращает ссылку на новый элемент, который только что был создан.</p>
	<p><i>.text("New paragraph!")</i>  - метод <a href="https://github.com/mbostock/d3/wiki/Selections#text"><i>text()</i></a> в качестве аргумента принимает строку и вставляет ее между открывающимся и закрывающимся тегами выборки. Так как предыдущий метод возвращает ссылку на наш новый тег <i>p</i>, этот код вставляет переданный текст между тегами <i>&lt;p&gt;</i> и <i>&lt;/p&gt;</i>.(Если между тегами будет существовать текст, то он будет перезаписан).</p>
	<p><i>;</i> - самый важный символ, который указывает на окончание этой строки кода.</p>
	<br/>
	<h3>Удобство</h3>
	<p>Многие, но не все D3 методы возвращают выборку(хотя, по правде говоря, ссылку на эту выборку), что открывает возможность создавать цепочки методов. Обычно, метод возвращает ссылку на элемент, у которого этот метод был вызван, но не всегда.</p>
	<p>Поэтому необходимо запомнить: когда пользуешься цепочками методов - порядок следования методов важен. Следующий вызываемый метод должен соответствовать методу объекта, возвращаемого текущим методом. Если вы соблюдаете порядок, действия методов не приведут к ожидаемому результату.</p>
	<p>Если вы не знаете, что нужно передавать функции на вход, и что получится на выходе - смело пользуйтесь <a href="https://github.com/mbostock/d3/wiki/API-Reference">документацией</a>, она ваш лучший друг. В документации есть информация по каждому методу, включая информацию, возвращает ли метод какую-нибудь выборку.</p>
	<br/>
	<h3>Обходимся без цепочек методов</h3>
	<p>Наш простой код может быть переписан без использования цепочек методов:</p>
	<pre class="prettyprint linenums">
var body = d3.select("body");
var p = body.append("p");
p.text("New paragraph!");</pre>
	<p>Фу, какое безобразие! Такой синтаксис действительно нужен, если, например, вы вызываете так много функций, что просто не имеет смысла их вызывать одна за другой. Или просто потому, что организовав таким образом код, он стал более понятен вам.</p>
						
						<div class="row bg-cyan" id="bottom_navigation" style="padding: 20px 0; display: none;">
						</div>
					</div>
				</div>
				<!--div class="row">
					<div class="span12">
						<div id="disqus_thread"></div>
					</div>
				</div-->
				<div class="row">
					<div class="span12" style="padding-top: 30px; text-align:right;">
						<span class="text-muted">Автором оригинального текста книги <a href="http://alignedleft.com/tutorials/d3">D3 Tutorials</a> является <a href="http://alignedleft.com/">Scott Murray</a></span>
						<br/>
						<span class="text-muted">На русский язык перевел <a href="http://serganbus.github.io/">Ivanov Sergey</a>. 2014 год</span>
					</div>
				</div>
			</div>
		</div>
		
		<!--script type="text/javascript">
		var lPageName_str = location.href.match(/[^/]+\.html/i)[0];
		var lPageDescription_str = getPageProperty(lPageName_str, "description");
		
		/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = "serganbus"; // required: replace example with your forum shortname
		var disqus_identifier = "http://serganbus.github.io//d3tutorials/" + lPageName_str;
		var disqus_url = "http://serganbus.github.io//d3tutorials/" + lPageName_str;
		var disqus_category_id = "3309433";
		
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
		</script-->
		
	</body>
</html>
