<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<link rel="stylesheet" href="css/metro-bootstrap.css">
		<link rel="stylesheet" href="css/metro-bootstrap-responsive.css">
		<link rel="stylesheet" href="css/iconFont.css">
		<link rel="stylesheet" href="js/prettify/prettify.css">

        <script src="js/jquery/jquery.min.js"></script>
        <script src="js/jquery/jquery.widget.min.js"></script>
        <script src="js/jquery/jquery.mousewheel.js"></script>
		<script src="js/prettify/prettify.js"></script>
        <script src="js/metro/metro.min.js"></script>
		
		<script src="js/docs.js"></script>
		<script src="js/github.info.js"></script>
	
		<title>Цепочки методов</title>
	</head>
	<body class="metro">
		<div class="container">
			<div align="center">
		<h1>Цепочки методов</h1>
	</div>
	<br/>
	<p>D3 ловко использует технику, которая называется цепочками методов, которую вы можете легко узнать, если пользовались библиотекой jQuery. Методы вызываются последовательно один за другим в одной строке кода, выполняя несколько действий - это называется цепочкой методов. Эта техника может быть очень быстрой и удобной, но необходимо понимать, как это работает, чтобы потом часами не сидеть за отладкой кода.</p>
	<p>Так, функции и методы это лишь два разных слова, обозначающих одно и тоже: кусок кода, который может принимать аргументы на вход, выполняет некоторые действия, после чего возвращает некоторые данные тому, кто вызвал метод.</p>
	<p>Давайте заново посмотрим на нашу первую строку кода, использующую D3(<a href="http://alignedleft.com/content/03-tutorials/01-d3/50-chaining-methods/index.html">Демо страница тут</a>):</p>
	<pre class="prettyprint linenums">d3.select("body").append("p").text("New paragraph!");</pre>
	<p>Это может выглядеть как большая каша, в особенности, если вы новичок в программировании. Итак, первым делом нужно усвоить, что JavaScript, также как и HTML, не волнуют пробелы и переходы на новую строку, так что вы можете написать каждый метод на отдельной строке для лучшей наглядности:</p>
	<pre class="prettyprint linenums">
d3.select("body")
    .append("p")
    .text("New paragraph!");</pre>
	<p>Каждый придерживается своего стиля оформления кода. Использование отступов, переходов на новую строку или пробелов(либо табов) работает на вас, помогая лучше воспринимать код./p>
	<br/>
	<h3>Одна ссылка в момент времени</h3>
	<p>Давайте разберем каждый кусок кода:</p>
	<p>d3 -  ссылается на D3 объект, из которого мы имеем доступ к методам D3.</p>
	<p>.select("body") - дает методу <a href="https://github.com/mbostock/d3/wiki/Selections#wiki-d3_select">select()</a> CSS-селектор на вход, а метод, в свою очередь, возвращает ссылку на первый элемент в DOM'e, который подходит под описание селектора(необходимо использовать метод selectAll() для получения группы объектов). В данном случае, нам нужен элемент body, поэтому ссылка на body используется следующим методом в нашей цепочке.</p>
	<p>.append("p") - метод <a href="https://github.com/mbostock/d3/wiki/Selections#append">append()</a> создает любой DOM-элемент, указанный вами и добавляет его в конец(внутрь) выборки. В нашем случае мы хотим создать новый параграф p внутри тега body. Мы указали p как аргумент функции, которая вызывается у элемента body, который мы выбрали вызовом предыдущего метода select(). В конце-концов, append() возвращает ссылку на новый элемент, который только что был создан.</p>
	<p>.text("New paragraph!")  - метод <a href="https://github.com/mbostock/d3/wiki/Selections#text">text()</a> в качестве аргумента принимает строку и вставляет ее между открывающимся и закрывающимся тегами выборки. Так как предыдущий метод возвращает ссылку на наш новый тег p, этот код вставляет переданный текст между тегами <i>&lt;p&gt;</i> и <i>&lt;/p&gt;</i>.(Если между тегами будет существовать текст, то он будет перезаписан).</p>
	<p>; - самый важный символ, который указывает на окончание этой строки кода.</p>
	<br/>
	<h3>Удобство</h3>
	<p>Многие, но не все D3 методы возвращают выборку(хотя, по правде говоря, ссылку на эту выборку), что открывает возможность создавать цепочки методов. Обычно, метод возвращает ссылку на элемент, у которого этот метод был вызван, но не всегда.</p>
	<p>Поэтому необходимо запомнить: когда пользуешься цепочками методов - порядок следования методов важен. Следующий вызываемый метод должен соответствовать методу объекта, возвращаемого текущим методом. Если вы соблюдаете порядок, действия методов не приведут к ожидаемому результату.</p>
	<p>Если вы не знаете, что нужно передавать функции на вход, и что получится на выходе - смело пользуйтесь <a href="https://github.com/mbostock/d3/wiki/API-Reference">документацией</a>, она ваш лучший друг. В документации есть информация по каждому методу, включая информацию, возвращает ли метод какую-нибудь выборку.</p>
	<br/>
	<h3>Обходимся без цепочек методов</h3>
	<p>Наш простой код может быть переписан без использования цепочек методов:</p>
	<pre class="prettyprint linenums">
var body = d3.select("body");
var p = body.append("p");
p.text("New paragraph!");</pre>
	<p>Фу, какое безобразие! Такой синтаксис действительно нужен, если, например, вы вызываете так много функций, что просто не имеет смысла их вызывать одна за другой. Или просто потому, что организовав таким образом код, он стал более понятен вам.</p>
		</div>
	</body>
</html>
