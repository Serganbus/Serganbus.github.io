<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta name="description" content="Визуализация данных, пошаговое руководство, книга по D3" />
		<meta name="keywords" content="code, art, design, data, visualization, generative, algorithmic, processing, d3, d3.js, book, maps, код, данные, искусство, визуализация, обработка данных, книга, отображение данных" />
		<meta name="author" content="Иванов Сергей" />
	
		<link rel="stylesheet" href="css/metro-bootstrap.css">
		<link rel="stylesheet" href="css/metro-bootstrap-responsive.css">
		<link rel="stylesheet" href="css/iconFont.css">
		<link rel="stylesheet" href="js/prettify/prettify.css">

        <script src="js/jquery/jquery.min.js"></script>
        <script src="js/jquery/jquery.widget.min.js"></script>
        <script src="js/jquery/jquery.mousewheel.js"></script>
		<script src="js/prettify/prettify.js"></script>
        <script src="js/metro/metro.min.js"></script>
		
		<script src="js/docs.js"></script>
		<script src="js/github.info.js"></script>
		<script type="text/javascript">
			var lNavigationDescriptor_obj_arr = [
				{
					pageName : "about.html",
					description : "Об этом руководстве",
					prevPageName : "",
					nextPageName : "fundamentals.html"
				},
				{
					pageName : "fundamentals.html",
					description : "Основы",
					prevPageName : "about.html",
					nextPageName : "setup.html"
				},
				{
					pageName : "setup.html",
					description : "Установка",
					prevPageName : "fundamentals.html",
					nextPageName : "adding_elements.html"
				},
				{
					pageName : "adding_elements.html",
					description : "Добавление элементов",
					prevPageName : "setup.html",
					nextPageName : "chaining_methods.html"
				},
				{
					pageName : "chaining_methods.html",
					description : "Цепочки методов",
					prevPageName : "adding_elements.html",
					nextPageName : "binding_data.html"
				},
				{
					pageName : "binding_data.html",
					description : "Привязка данных",
					prevPageName : "chaining_methods.html",
					nextPageName : "using_your_data.html"
				},
				{
					pageName : "using_your_data.html",
					description : "Использование данных",
					prevPageName : "binding_data.html",
					nextPageName : "drawing_divs.html"
				},
				{
					pageName : "drawing_divs.html",
					description : "Рисование с использованием блоков",
					prevPageName : "using_your_data.html",
					nextPageName : "power_of_data.html"
				},
				{
					pageName : "power_of_data.html",
					description : "Сила метода data()",
					prevPageName : "drawing_divs.html",
					nextPageName : "svg_primer.html"
				},
				{
					pageName : "svg_primer.html",
					description : "Пример с использованием SVG",
					prevPageName : "power_of_data.html",
					nextPageName : "drawing_svgs.html"
				},
				{
					pageName : "drawing_svgs.html",
					description : "Рисование с использованием SVG-элементов",
					prevPageName : "svg_primer.html",
					nextPageName : "types_of_data.html"
				},
				{
					pageName : "types_of_data.html",
					description : "Типы данных",
					prevPageName : "drawing_svgs.html",
					nextPageName : "making_bar_chart.html"
				},
				{
					pageName : "making_bar_chart.html",
					description : "Делаем столбиковую диаграмму",
					prevPageName : "types_of_data.html",
					nextPageName : "making_scatterplot.html"
				},
				{
					pageName : "making_scatterplot.html",
					description : "Делаем точечную диаграмму",
					prevPageName : "making_bar_chart.html",
					nextPageName : "scales.html"
				},
				{
					pageName : "scales.html",
					description : "Масштабирование",
					prevPageName : "making_scatterplot.html",
					nextPageName : "axes.html"
				},
				{
					pageName : "axes.html",
					description : "Координатные оси",
					prevPageName : "scales.html",
					nextPageName : ""
				}
			];
			
			function getPageProperty(aPageName_str, aPropertyName_str) {
				var lPagesCount_int = lNavigationDescriptor_obj_arr.length;
				for (var i = 0; i < lPagesCount_int; i++) {
					var lPageDescriptor_obj = lNavigationDescriptor_obj_arr[i];
					var lPGPageName_str = lPageDescriptor_obj.pageName;
					if (aPageName_str === lPGPageName_str) {
						return lPageDescriptor_obj[aPropertyName_str];
					}
				}
				return "";
			}
			
			window.onload = function () {
				var lPageName_str = location.href.match(/[^/]+\.html/i)[0];
				var lPagesCount_int = lNavigationDescriptor_obj_arr.length;
				for (var i = 0; i < lPagesCount_int; i++) {
					var lPageDescriptor_obj = lNavigationDescriptor_obj_arr[i];
					var lPGPageName_str = lPageDescriptor_obj.pageName;
					if (lPageName_str === lPGPageName_str) {
						var lPGPrevPageName_str = lPageDescriptor_obj.prevPageName;
						var lPGPrevPageDescription_str = getPageProperty(lPGPrevPageName_str, "description");
						var lPGNextPageName_str = lPageDescriptor_obj.nextPageName;
						var lPGNExtPageDescription_str = getPageProperty(lPGNextPageName_str, "description");
						
						var lTopNav_e = $("#top_navigation");
						var lBottomNav_e = $("#bottom_navigation");
						
						if (lPGPrevPageName_str.trim().length > 0) {
							var lPrevPageNav_e = $("<div class=\"span4\" align=\"center\"/>");
							var lLinkText_str = "<i class=\"icon-arrow-left-3\"></i>&nbsp;" + lPGPrevPageDescription_str;
							var lLink_e = $("<a class=\"seganav\" />").attr("href", lPGPrevPageName_str).html(lLinkText_str);
							lPrevPageNav_e.append(lLink_e);
							var lCopyPrevPageNav_e = lPrevPageNav_e.clone();
							lBottomNav_e.append(lPrevPageNav_e);
							lTopNav_e.append(lCopyPrevPageNav_e);
						}
						
						var lContentPageNav_e = $("<div align=\"center\"/>");
						if (lPGPrevPageName_str.trim().length > 0) {
							lContentPageNav_e.addClass("span4");
						} else {
							lContentPageNav_e.addClass("span4 offset4");
						}
						var lLinkText_str = "<i class=\"icon-book\"></i>&nbsp;" + "Оглавление";
						var lLink_e = $("<a class=\"seganav\" />").attr("href", "index.html").html(lLinkText_str);
						lContentPageNav_e.append(lLink_e);
						var lCopyContentPageNav_e = lContentPageNav_e.clone();
						lBottomNav_e.append(lContentPageNav_e);
						lTopNav_e.append(lCopyContentPageNav_e);
						
						if (lPGNextPageName_str.trim().length > 0) {
							var lNextPageNav_e = $("<div class=\"span4\" align=\"center\"/>");
							var lLinkText_str = lPGNExtPageDescription_str + "&nbsp;<i class=\"icon-arrow-right-3\"></i>";
							var lLink_e = $("<a class=\"seganav\" />").attr("href", lPGNextPageName_str).html(lLinkText_str);
							lNextPageNav_e.append(lLink_e);
							var lCopyNextPageNav_e = lNextPageNav_e.clone();
							lBottomNav_e.append(lNextPageNav_e);
							lTopNav_e.append(lCopyNextPageNav_e);
						}
						break;
					}
				}
				if (lPageName_str !== "index.html") {
					$("#top_navigation").show();
					$("#bottom_navigation").show();
				}
			};
		</script>
		<title>Рисование с использованием блоков</title>
	</head>
	<body class="metro">
		<div class="container">
			<div class="grid">
				<div class="row">
					<div class="span12">
						<div class="row bg-cyan" id="top_navigation" style="padding: 20px 0; display: none;">
						</div>
						
						<div align="center">
		<h1>Рисование с использованием блоков</h1>
	</div>
	<br/>
	<p>Пришло время визуализировать данные.</p>
	<p>Давайте продолжим работу с нашим простым набором данных, используемым ранее:</p>
	<pre class="prettyprint linenums">var dataset = [ 5, 10, 15, 20, 25 ];</pre>
	<p>Мы будем использовать его для генерирования супер-простой столбиковой диаграммы. Столбиковые диаграммы по сути являются набором прямоугольников, а HTML тег <i>&lt;div&gt;</i> - это самый простой способ нарисовать прямоугольник(Опять же, для веб-браузера все является прямоугольниками, поэтому вы можете запросто адаптировать этот пример для использования <i>span</i>-ов или любых других элементов на ваше усмотрение).</p>
	<p>Этот <i>div</i> может быть легко приспособлен для отображения столбика:</p>
	<div style="display: inline-block; width: 20px; height: 75px; background-color: teal;"></div>
	<pre class="prettyprint linenums">
&lt;div style="display: inline-block;
            width: 20px;
            height: 75px;
            background-color: teal;"&gt;&lt;/div&gt;</pre>
	<p>(Следуя веб-стандартам, этот код является семантически неверным. Обычно мы не должны использовать пустой блок <i>div</i> для реализации визуальных эффектов, но при написании кода в этом руководстве мы отклоняемся от правил.)</p>
	<p>Так как это <i>div</i>, его атрибуты <i>width</i> и <i>height</i> заданы в CSS-стилях. Каждый столбик в нашей диаграмме будет наследовать те же свойства(исключение только <i>height</i>), поэтому ниже приведен код для описания общих стилей и выделен в CSS-класс <i>bar</i>:</p>
	<pre class="prettyprint linenums">
div.bar {
    display: inline-block;
    width: 20px;
    height: 75px;   /* We'll override this later */
    background-color: teal;
}</pre>
	<p>Теперь к каждому <i>div</i>'у надо присвоить класс <i>bar</i>, чтобы наши общие стили применялись к нему:</p>
	<pre class="prettyprint linenums">&lt;div class="bar"&gt;&lt;/div&gt;</pre>
	<p>Добавить атрибут класса к элементу с использованием D3 можно с помощью метода <i>selection.attr()</i>. Очень важно понимать разницу между методами <i>attr()</i> и <i>style()</i>.</p>
	<br/>
	<h3>Установка атрибутов</h3>
	<p>Метод <a href="https://github.com/mbostock/d3/wiki/Selections#attr"><i>attr()</i></a> используется для установки элементу атрибута и его значения. HTML-атрибутом является любая пара свойство/значение, которые можно включать для элемента между скобками <i><></i>. Например, эти HTML-элементы:</p>
	<pre class="prettyprint linenums">
&lt;p class="caption"&gt;
&lt;select id="country"&gt;
&lt;img src="logo.png" width="100px" alt="Logo" /&gt;
</pre>
	<p>в общем хранят 5 атрибутов(и соответствующих им значения), все из них могут быть установлены с использованием метода <i>attr()</i>:</p>
	<pre class="prettyprint linenums">
class   |   caption
id      |   country
src     |   logo.png
width   |   100px
alt     |   Logo</pre>
	<p>Для установки нашим <i>div</i>'ам класса <i>bar</i> мы можем использовать:</p>
	<pre class="prettyprint linenums">.attr("class", "bar")</pre>
	<br/>
	<h3>Заметка по классам</h3>
	<p>Заметьте, что у элемента class является HTML-атрибутом. Класс, в свою очередь, используется для ссылки на правила в CSS-стилях. Это может вызывать некоторую путаницу, поскольку есть разница между установкой атрибута <i>class</i> и применении стиля напрямую к элементу через написание стилей в атрибуте элемента <i>style</i>. Вы можете использовать оба варианта. Конечно, вы должны использовать подход, который больше вам по душе, но я рекомендую использовать описание класса в CSS-свойствах, а затем применить этот класс к множественным элементам(путем установки атрибута <i>class</i>), или прописать все стили в атрибуте <i>style</i> элемента(когда определенное свойство должно быть уникальным).</p>
	<p>Также я хочу вскользь упомянуть о методе D3 <i>classed()</i>, который может быть использован для быстрого применения или удаления классов стилей элемента. Строка кода выше может быть заменена на:</p>
	<pre class="prettyprint linenums">.classed("bar", true)</pre>
	<br/>
	<h3>Вернемся к столбикам</h3>
	<p>Сложив все это вместе с нашим набором данных, получим законченный D3 код:</p>
	<pre class="prettyprint linenums">
var dataset = [ 5, 10, 15, 20, 25 ];

d3.select("body").selectAll("div")
    .data(dataset)
    .enter()
    .append("div")
    .attr("class", "bar");</pre>
	<img src="images/drawing_divs_1.png" alt="Результат работы кода">
	<p>Загляните на <a href="http://alignedleft.com/content/03-tutorials/01-d3/80-drawing-divs/1.html">демо-страницу с этим кодом</a>. Чтобы убедиться в этом, откройте исходники кода, и откройте веб-инспектор, чтобы увидеть, что происходит. Вы должны увидеть пять вертикальных столбиков, которые сгенерированы по одному для каждого значения в наборе данных. Без пробелов между ними, они смотрятся как один большой квадрат.</p>
	<br/>
	<h3>Устанавливаем стили</h3>
	<p>Метод <a href="https://github.com/mbostock/d3/wiki/Selections#style">style()</a> используется для установки CSS-свойств и значений напрямую. HTML-элеметну. Это эквивалентно включению CSS-правил в атрибут <i>style</i> прямо в HTML-коде, как на примере:</p>
	<pre class="prettyprint linenums">&lt;div style="height: 75px;"&gt;&lt;/div&gt;</pre>
	<p>В столбиковой диаграмме высота каждого столбика должна быть фукнцией от соответствующего значения. Давайте добавим это в конец нашего D3 кода:</p>
	<pre class="prettyprint linenums">
.style("height", function(d) {
    return d + "px";
});</pre>
	<img src="images/drawing_divs_2.png" alt="Результат работы кода">
	<p>Взгяните на результат на <a href="http://alignedleft.com/content/03-tutorials/01-d3/80-drawing-divs/2.html">демо-странице</a>. Вы должны увидеть маленькую стобиковую диаграмму! </p>
	<p>Когда D3 проходит через каждое значение входного набора, значение <i>d</i> будет хранить соответствующее значение набора данных. Поэтому мы устанавливаем высоту в зависимости от значения <i>d</i>(текущее значение) и прибавляем <i>px</i>(то есть указываем единицу измерения). Высота <i>div</i>'ов будет таким: <i>5px, 10px, 15px, 20px и 25px</i>.</p>
	<p>Это может выглядеть немного просто, поэтому давайте сделаем наши столбики немного выше:</p>
	<pre class="prettyprint linenums">
.style("height", function(d) {
    var barHeight = d * 5;  //Scale up by factor of 5
    return barHeight + "px";
});</pre>
	<p>и добавим небольшой просвет справа от каждого столбика:</p>
	<pre class="prettyprint linenums">margin-right: 2px;</pre>
	<img src="images/drawing_divs_3.png" alt="Результат работы кода">
	<p>Круто! Здесь представлена наша <a href="http://alignedleft.com/content/03-tutorials/01-d3/80-drawing-divs/3.html">финальная демо-страница</a>. Опять же, просмотрите исходники кода, а затем, используя веб-инспектор сравните с окончательной страницей.</p>
						
						<div class="row bg-cyan" id="bottom_navigation" style="padding: 20px 0; display: none;">
						</div>
					</div>
				</div>
				<!--div class="row">
					<div class="span12">
						<div id="disqus_thread"></div>
					</div>
				</div-->
				<div class="row">
					<div class="span12" style="padding-top: 30px;">
						<p class="text-muted text-right">Автор перевода <a href="http://serganbus.github.io/">Иванов Сергей</a>. 2014 год</p>
					</div>
				</div>
			</div>
		</div>
		
		<!--script type="text/javascript">
		var lPageName_str = location.href.match(/[^/]+\.html/i)[0];
		var lPageDescription_str = getPageProperty(lPageName_str, "description");
		
		/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = "serganbus"; // required: replace example with your forum shortname
		var disqus_identifier = "http://serganbus.github.io//d3tutorials/" + lPageName_str;
		var disqus_url = "http://serganbus.github.io//d3tutorials/" + lPageName_str;
		var disqus_category_id = "3309433";
		
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
		</script-->
		
	</body>
</html>
