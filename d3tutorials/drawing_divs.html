<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<link rel="stylesheet" href="css/metro-bootstrap.css">
		<link rel="stylesheet" href="css/metro-bootstrap-responsive.css">
		<link rel="stylesheet" href="css/iconFont.css">
		<link rel="stylesheet" href="js/prettify/prettify.css">

        <script src="js/jquery/jquery.min.js"></script>
        <script src="js/jquery/jquery.widget.min.js"></script>
        <script src="js/jquery/jquery.mousewheel.js"></script>
		<script src="js/prettify/prettify.js"></script>
        <script src="js/metro/metro.min.js"></script>
		
		<script src="js/docs.js"></script>
		<script src="js/github.info.js"></script>
	
		<title>Рисование с использованием блоков</title>
	</head>
	<body class="metro">
		<div class="container">
			<div align="center">
		<h1>Рисование с использованием блоков</h1>
	</div>
	<br/>
	<p>Пришло время визуализировать данные.</p>
	<p>Давайте продолжим работу с нашим простым набором данных, используемым ранее:</p>
	<pre class="prettyprint linenums">var dataset = [ 5, 10, 15, 20, 25 ];</pre>
	<p>Мы будем использовать его для генерирования супер-простой столбиковой диаграммы. Столбиковые диаграммы по сути являются набором прямоугольников, а HTML тег <div> - это самый простой способ нарисовать прямоугольник(Опять же, для веб-браузера все является прямоугольниками, поэтому вы можете запросто адаптировать этот пример для использования span-ов или любых других элементов на ваше усмотрение).</p>
	<p>Этот div может быть легко приспособлен для отображения столбика:</p>
	<div style="display: inline-block; width: 20px; height: 75px; background-color: teal;"></div>
	<pre class="prettyprint linenums">
&lt;div style="display: inline-block;
            width: 20px;
            height: 75px;
            background-color: teal;"&gt;&lt;/div&gt;</pre>
	<p>(Следуя веб-стандартам, этот код является семантически неверным. Обычно мы не должны использовать пустой блок div для реализации визуальных эффектов, но при написании кода в этом руководстве мы отклоняемся от правил.)</p>
	<p>Так как это div, его атрибуты width и height заданы в CSS-стилях. Каждый столбик в нашей диаграмме будет наследовать те же свойства(исключение только height), поэтому ниже приведен код для описания общих стилей и выделен в CSS-класс bar:</p>
	<pre class="prettyprint linenums">
div.bar {
    display: inline-block;
    width: 20px;
    height: 75px;   /* We'll override this later */
    background-color: teal;
}</pre>
	<p>Теперь к каждому div'у надо присвоить класс bar, чтобы наши общие стили применялись к нему:</p>
	<pre class="prettyprint linenums">&lt;div class="bar"&gt;&lt;/div&gt;</pre>
	<p>Добавить атрибут класса к элементу с использованием D3 можно с помощью метода selection.attr(). Очень важно понимать разницу между методами attr() и style().</p>
	<br/>
	<h3>Установка атрибутов</h3>
	<p>Метод <a href="https://github.com/mbostock/d3/wiki/Selections#attr">attr()</a> используется для установки элементу атрибута и его значения. HTML-атрибутом является любая пара свойство/значение, которые можно включать для элемента между скобками <>. Например, эти HTML-элементы:</p>
	<pre class="prettyprint linenums">
&lt;p class="caption"&gt;
&lt;select id="country"&gt;
&lt;img src="logo.png" width="100px" alt="Logo" /&gt;
</pre>
	<p>в общем хранят 5 атрибутов(и соответствующих им значения), все из них могут быть установлены с использованием метода attr():</p>
	<pre class="prettyprint linenums">
class   |   caption
id      |   country
src     |   logo.png
width   |   100px
alt     |   Logo</pre>
	<p>Для установки нашим div'ам класса bar мы можем использовать:</p>
	<pre class="prettyprint linenums">.attr("class", "bar")</pre>
	<br/>
	<h3>Заметка по классам</h3>
	<p>Заметьте, что у элемента class является HTML-атрибутом. Класс, в свою очередь, используется для ссылки на правила в CSS-стилях. Это может вызывать некоторую путаницу, поскольку есть разница между установкой атрибута class и применении стиля напрямую к элементу через написание стилей в атрибуте элемента style. Вы можете использовать оба варианта. Конечно, вы должны использовать подход, который больше вам по душе, но я рекомендую использовать описание класса в CSS-свойствах, а затем применить этот класс к множественным элементам(путем установки атрибута class), или прописать все стили в атрибуте style элемента(когда определенное свойство должно быть уникальным).</p>
	<p>Также я хочу вскользь упомянуть о методе D3 classed(), который может быть использован для быстрого применения или удаления классов стилей элемента. Строка кода выше может быть заменена на:</p>
	<pre class="prettyprint linenums">.classed("bar", true)</pre>
	<br/>
	<h3>Вернемся к столбикам</h3>
	<p>Сложив все это вместе с нашим набором данных, получим законченный D3 код:</p>
	<pre class="prettyprint linenums">
var dataset = [ 5, 10, 15, 20, 25 ];

d3.select("body").selectAll("div")
    .data(dataset)
    .enter()
    .append("div")
    .attr("class", "bar");</pre>
	<img src="images/drawing_divs_1.png" alt="Результат работы кода">
	<p>Загляните на <a href="http://alignedleft.com/content/03-tutorials/01-d3/80-drawing-divs/1.html">демо-страницу с этим кодом</a>. Чтобы убедиться в этом, откройте исходники кода, и откройте веб-инспектор, чтобы увидеть, что происходит. Вы должны увидеть пять вертикальных столбиков, которые сгенерированы по одному для каждого значения в наборе данных. Без пробелов между ними, они смотрятся как один большой квадрат.</p>
	<br/>
	<h3>Устанавливаем стили</h3>
	<p>Метод style()(https://github.com/mbostock/d3/wiki/Selections#style) используется для установки CSS-свойств и значений напрямую. HTML-элеметну. Это эквивалентно включению CSS-правил в атрибут style прямо в HTML-коде, как на примере:</p>
	<pre class="prettyprint linenums">&lt;div style="height: 75px;"&gt;&lt;/div&gt;</pre>
	<p>В столбиковой диаграмме высота каждого столбика должна быть фукнцией от соответствующего значения. Давайте добавим это в конец нашего D3 кода:</p>
	<pre class="prettyprint linenums">
.style("height", function(d) {
    return d + "px";
});</pre>
	<img src="images/drawing_divs_2.png" alt="Результат работы кода">
	<p>Взгяните на результат на <a href="http://alignedleft.com/content/03-tutorials/01-d3/80-drawing-divs/2.html">демо-странице</a>. Вы должны увидеть маленькую стобиковую диаграмму! </p>
	<p>Когда D3 проходит через каждое значение входного набора, значение d будет хранить соответствующее значение набора данных. Поэтому мы устанавливаем высоту в зависимости от значения d(текущее значение) и прибавляем px(то есть указываем единицу измерения). Высота div'ов будет таким: 5px, 10px, 15px, 20px и 25px.</p>
	<p>Это может выглядеть немного просто, поэтому давайте сделаем наши столбики немного выше:</p>
	<pre class="prettyprint linenums">
.style("height", function(d) {
    var barHeight = d * 5;  //Scale up by factor of 5
    return barHeight + "px";
});</pre>
	<p>и добавим небольшой просвет справа от каждого столбика:</p>
	<pre class="prettyprint linenums">margin-right: 2px;</pre>
	<img src="images/drawing_divs_3.png" alt="Результат работы кода">
	<p>Круто! Мы можем пойти на SIGGRAPH с этим графиком.</p>
	<p>Здесь представлена наша <a href="http://alignedleft.com/content/03-tutorials/01-d3/80-drawing-divs/3.html">финальная демо-страница</a>. Опять же, просмотрите исходники кода, а затем, используя веб-инспектор сравните с окончательной страницей.</p>
		</div>
	</body>
</html>
